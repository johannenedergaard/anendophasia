---
title: "Anendophasia analysis"
output:
  html_document:
    df_print: paged
    keep_md: true
---

Excluded nine participants for responding randomly, missing at least one out of the four experiments, or otherwise not complying with task instructions.

```{r, include=FALSE}
# read in full browser interaction data
library(tidyverse)
library(lme4)
library(lmerTest)
color_palette <- c('#88CCEE', '#44AA99', '#117733', '#332288', '#DDCC77', '#999933','#CC6677', '#882255', '#AA4499', '#DDDDDD') # Tol_muted from https://zenodo.org/record/3381072#.Y0_5ilJBw-Q

browser_interactions <- read.csv('browser_df_anendophasia_full.csv',row.names = 1)
```

## Same/different judgments

Prior to this excluded trials above 5 seconds and below 200 ms.

```{r, include=FALSE}
same_different_trials <- read.csv('same_different_trials_221017.csv',row.names = 1)
```

#### Descriptive statistics by group: Same/different judgments

```{r, include=FALSE}
# how many correct
100-(table(same_different_trials$correct)[1]/table(same_different_trials$correct)[2]*100)
# how many correct by group
SD_correct <- same_different_trials %>%
  group_by(high_low_verbal) %>%
  summarise(correct = sum(correct)/n())
SD_correct

SD_RT <- same_different_trials %>%
  group_by(high_low_verbal) %>%
  summarise(rt = mean(rt,na.rm=T))
SD_RT
```

Generally, participants made the correct judgment on `r round(100-(table(same_different_trials$correct)[1]/table(same_different_trials$correct)[2]*100), 2)` % of trials. This did not differ between the high verbal (`r round(SD_correct$correct[1]*100,2)` %) and the low verbal group (`r round(SD_correct$correct[2]*100,2)`. In subsequent analyses and plots, we only include correct trials. See Figure XX below for reaction times between the high verbal and low verbal groups for category ('do these two animals belong to the same category?') or identity ('are these two animals identical?') judgments.

```{r, include=FALSE}
SD_rt_df <- same_different_trials %>%
  filter(correct == 1) %>%
  group_by(high_low_verbal, worker_id, judgment_type) %>%
  summarise(mean_rt = mean(rt, na.rm=T))

```
```{r, echo=FALSE}
ggplot(SD_rt_df, aes(judgment_type, mean_rt, color=high_low_verbal)) +
  geom_violin(position = position_dodge(1),alpha=0.2) +
  geom_boxplot(position = position_dodge(1)) +
  theme_bw()+
  labs(y ='RT', title = 'Judgment types and verbal score', x = 'Category or identity judgments') +
  scale_color_manual(values = color_palette[c(4,6)])
```

#### Statistical models: Same/different judgments

```{r, include=FALSE}
category_model <- glmer(rt ~ judgment_type * VerbalScored + (1|worker_id), 
                        subset(same_different_trials, correct ==1),
                       family=Gamma(link='identity'))
summary(category_model)
```

We conducted a linear mixed model of verbal score and judgment type predicting reaction time as well as the interaction between them including random intercepts per participant. This model indicated significant main effects of both judgment type and verbal score. Identity judgments were faster than category judgments ($\beta$ = `r round(summary(category_model)$coefficients[2,1],2)`, SE = `r round(summary(category_model)$coefficients[2,2],2)`, t = `r round(summary(category_model)$coefficients[2,3],2)`, p < .001)), and a higher verbal score was also associated with faster reaction times ($\beta$ = `r round(summary(category_model)$coefficients[3,1],2)`, SE = `r round(summary(category_model)$coefficients[3,2],2)`, t = `r round(summary(category_model)$coefficients[3,3],2)`, p < .001). There was no significant interaction effect (p = `r round(summary(category_model)$coefficients[4,4],3)`).

The key test for this experiment was whether the two groups behaved differently when giving correct 'DIFFERENT' responses on identity trials when the two images belonged to the same category. That is, we expected high verbal participants to be more susceptible to interference from a same-category distractor.

```{r, include=F}
SD_rt_df_key_comparison <- same_different_trials %>%
  filter(judgment_type == 'identical_image' & correct ==1 & answer =='different') %>%
  group_by(high_low_verbal, worker_id, judgment_type, same_category_animal,cat_or_dog) %>%
  summarise(mean_rt = mean(rt, na.rm=T))
```
```{r}
ggplot(SD_rt_df_key_comparison, aes(same_category_animal, mean_rt, color=high_low_verbal)) +
  geom_violin(position = position_dodge(1),alpha=0.2) +
  geom_boxplot(position = position_dodge(1)) +
  theme_bw()+
  labs(y ='RT', title = 'Latency to correct DIFFERENT response on identity trials', x = 'Between or within category distractor') +
  scale_color_manual(values = color_palette[c(4,6)])
```

```{r, include=FALSE}

latency_to_different <- glmer(rt ~ VerbalScored * same_category_animal + (1|worker_id),
                            subset(same_different_trials, judgment_type == 'identical_image' & correct ==1 & answer =='different'),family=Gamma(link='identity'))
summary(latency_to_different)
```
A linear mixed model with verbal score and category membership of the distractor as predictors, including random intercepts per participant, provided evidence that high verbal participants were not particularly affected by the within-category interference (interaction effect: p = `r round(summary(latency_to_different)$coefficients[4,4],3)`). However, there was a significant main effect of category membership of the distractor with within-category distractors being associated with slower reaction times ($\beta$ = `r round(summary(latency_to_different)$coefficients[3,1],2)`, SE = `r round(summary(latency_to_different)$coefficients[3,2],2)`, t = `r round(summary(latency_to_different)$coefficients[3,3],2)`, p < .001). There was also a significant main effect of verbal score once again with higher verbal score being associated with faster reaction times ($\beta$ = `r round(summary(latency_to_different)$coefficients[2,1],2)`, SE = `r round(summary(latency_to_different)$coefficients[2,2],2)`, t = `r round(summary(latency_to_different)$coefficients[2,3],2)`, p < .001).

#### Additional analyses

We also checked whether the kind of animal made a difference on a within-category distractor trial.

```{r, echo=FALSE}
ggplot(subset(SD_rt_df_key_comparison, cat_or_dog != 'cat-dog'), aes(cat_or_dog, mean_rt, color=high_low_verbal)) +
  geom_violin(position = position_dodge(1),alpha=0.2) +
  geom_boxplot(position = position_dodge(1)) +
  theme_bw()+
  labs(y ='RT', title = 'Latency to correct DIFFERENT response on identity trials', x = 'Image pair') +
  scale_color_manual(values = color_palette[c(4,6)])
```
```{r include=FALSE}
kind_of_animal_model <- glmer(rt ~ cat_or_dog * VerbalScored + (1|worker_id), 
                              data = subset(same_different_trials, judgment_type =='identical_image' & correct & answer=='same'),
                              family = Gamma(link='identity'))
summary(kind_of_animal_model) 
```
A linear mixed model with verbal score and animal pair (dog-dog or cat-cat) as predictors, including random intercepts per participant, provided evidence that dog-dog trials were faster than cat-cat trials ($\beta$ = `r round(summary(kind_of_animal_model)$coefficients[2,1],2)`, SE = `r round(summary(kind_of_animal_model)$coefficients[2,2],2)`, t = `r round(summary(kind_of_animal_model)$coefficients[2,3],2)`, p < .001). The model again corroborated the result that a higher verbal score was associated with faster reaction times ($\beta$ = `r round(summary(kind_of_animal_model)$coefficients[3,1],2)`, SE = `r round(summary(kind_of_animal_model)$coefficients[3,2],2)`, t = `r round(summary(kind_of_animal_model)$coefficients[3,3],2)`, p < .001). However, this effect of verbal score was less strong when the stimuli were dog-dog than when they were cat-cat as indicated by a significant interaction effect between verbal score and animal pair ($\beta$ = `r round(summary(kind_of_animal_model)$coefficients[4,1],2)`, SE = `r round(summary(kind_of_animal_model)$coefficients[4,2],2)`, t = `r round(summary(kind_of_animal_model)$coefficients[4,3],2)`, p < .001).

## Rhyme judgments

Excluded five rhyming pairs as they had below-chance performance for at least one group. These were bin/chin, cab/crab, rake/cake, wave/cave, and park/shark. 

```{r}
rhyming_trials <- read.csv('rhyming_trials_221017.csv',row.names = 1)
```

## Verbal working memory

```{r}
# phonSet = c('bought', 'sort','taut','caught','wart')
# orthoSet = c('rough', 'cough', 'through','dough','bough')
# ctrlSet = c('plea','friend', 'sleigh','row','board')

phon_sim_trials <- read.csv('phon_sim_trials_221017.csv',row.names = 1)

```

## Task switching

Prior to this: excluded trials over 10 seconds.

```{r}
task_switch_trials <- read.csv('task_switch_trials_221017.csv',row.names = 1)
```


## Intertask correlations


